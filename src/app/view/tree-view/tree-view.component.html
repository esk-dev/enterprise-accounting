 <section class="node_container">
  <div class="node-header">
  <h1>Главные организаци</h1>
    <div class="action">
    <a *appRole [routerLink]="['/create/main-enterprise']" mat-flat-button color="primary"
      >Добавить организацию<mat-icon mat-list-icon>add</mat-icon></a
    >
  </div>
  </div>
  <ng-container *ngIf="enterprises$ | async as nodes">
    <ng-container *ngFor="let node of nodes">
      <div class="node">
          <div class="node-header">
            <button mat-icon-button (click)="nodeClicked(node.mainEnterprise._id)">
              <mat-icon >{{ isExpanded(node.mainEnterprise._id) ? 'close' : 'chevron_right' }}</mat-icon>
            </button>

            <mat-card-title>{{ node.mainEnterprise.fullName }}</mat-card-title>
            <div class="action">
                <a
                  *appRole
                  [routerLink]="['/edit/main-enterprise', node.mainEnterprise._id]"
                  mat-icon-button
                  color="primary"
                  ><mat-icon >mode_edit</mat-icon></a
                >
              </div>
          </div>
          <ng-container *ngIf="isExpanded(node.mainEnterprise._id)">
            <div class="node-content">
              <div class="node-content_row">
                <mat-card-subtitle>Полное наименование организации: </mat-card-subtitle>
                <mat-card-subtitle>{{ node.mainEnterprise.fullName }}</mat-card-subtitle>
              </div>
              <div class="node-content_row">
                <mat-card-subtitle>Краткое наименование организаци: </mat-card-subtitle
                ><mat-card-subtitle>{{ node.mainEnterprise.shortName }}</mat-card-subtitle>
              </div>
              <div class="node-content_row">
                <mat-card-subtitle>ИНН: </mat-card-subtitle>
                <mat-card-subtitle> {{ node.mainEnterprise.INN }}</mat-card-subtitle>
              </div>
              <div class="node-content_row">
                <mat-card-subtitle>КПП: </mat-card-subtitle>
                <mat-card-subtitle> {{ node.mainEnterprise.KPP }}</mat-card-subtitle>
              </div>
              <div class="node-content_row">
                <mat-card-subtitle>Учредитель: </mat-card-subtitle
                ><mat-card-subtitle> {{ node.mainEnterprise.founder }}</mat-card-subtitle>
              </div>
              <div class="node-content_row">
                <mat-card-subtitle>Адрес: </mat-card-subtitle>
                <mat-card-subtitle>
                  {{ node.mainEnterprise.addres }}
                </mat-card-subtitle>
              </div>
              <div class="node-content_row">
                <mat-card-subtitle>Номер телефона:</mat-card-subtitle>
                <mat-card-subtitle> {{ node.mainEnterprise.phone }}</mat-card-subtitle>
              </div>
            </div>

            <div class="sub node">
              <div class="node-header">
                <mat-card-title>Филиалы</mat-card-title>
              <div class="action">
                <a
                  *appRole
                  [routerLink]="['/create/sub-enterprise', node.mainEnterprise._id]"
                  mat-flat-button
                  color="primary"
                  >Добавить филиал<mat-icon mat-list-icon>add</mat-icon></a
                >
              </div>
              </div>
              <ng-container *ngIf="node.subEnterprises">
                <ng-container *ngFor="let subNode of node.subEnterprises">
                  
                  <div class="node-header">
                    <button mat-icon-button (click)="nodeClicked(subNode._id)">
                    <mat-icon >{{ isExpanded(subNode._id) ? 'close' : 'chevron_right' }}</mat-icon>
                    </button>
                    <mat-card-title>{{ subNode.officeAdress }}</mat-card-title>
                    <div>
                      <a
                        *appRole
                        [routerLink]="['/edit/sub-enterprise', subNode._id]"
                        mat-icon-button
                        color="primary"
                        ><mat-icon >mode_edit</mat-icon></a
                      >
                    </div>
                  </div>
                  <div class="node-content">
                    <ng-container *ngIf="isExpanded(subNode._id)">
                      <div class="node-content_row">
                        <mat-card-subtitle>Адрес офиса::</mat-card-subtitle>
                        <mat-card-subtitle> {{ subNode.officeAdress }}</mat-card-subtitle>
                      </div>
                                            <div class="node-content_row">
                        <mat-card-subtitle>Должностное лицо:</mat-card-subtitle>
                        <mat-card-subtitle> {{ subNode.official }}</mat-card-subtitle>
                      </div>
                                            <div class="node-content_row">
                        <mat-card-subtitle>Номер телефона:</mat-card-subtitle>
                        <mat-card-subtitle> {{ subNode.phone }}</mat-card-subtitle>
                      </div>
                    </ng-container>
                  </div>
                </ng-container>
              </ng-container>
            </div>
          </ng-container>
      </div>
    </ng-container>
  </ng-container>
</section>
